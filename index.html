<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Baroud App Pro ğŸ’</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { --primary: #00e676; --bg-dark: #121212; --card-bg: #1e1e1e; --danger: #ff1744; --edit: #ffcc00; }
        body { background: var(--bg-dark); color: #fff; font-family: 'Cairo', sans-serif; margin: 0; padding-bottom: 80px; min-height: 100vh; }
        
        /* Dashboard */
        .top-dashboard { background: linear-gradient(180deg, #1a1a1a 0%, #121212 100%); padding: 20px; border-radius: 0 0 30px 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); margin-bottom: 20px; }
        .brand-name { font-size: 1.4rem; font-weight: 900; }
        .brand-name span { color: var(--primary); }
        .balance-card { background: linear-gradient(135deg, #00b09b, #96c93d); padding: 20px; border-radius: 20px; text-align: center; color: #000; }
        .balance-amount { font-size: 2.5rem; font-weight: 900; }

        /* Cards */
        .list-container { padding: 0 15px; }
        .app-card { background: var(--card-bg); border-radius: 18px; padding: 15px; margin-bottom: 12px; display: flex; align-items: center; border: 1px solid #333; }
        .card-icon { width: 50px; height: 50px; background: rgba(0,230,118,0.1); color: var(--primary); border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 1.3rem; margin-left: 15px; }
        .card-info { flex: 1; }
        .card-info h3 { margin: 0; font-size: 1rem; }

        /* Nav */
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: #1a1a1a; padding: 10px 0; display: flex; justify-content: space-around; border-radius: 25px 25px 0 0; z-index: 900; }
        .nav-item { color: #666; background: none; border: none; display: flex; flex-direction: column; align-items: center; font-size: 0.8rem; }
        .nav-item.active { color: var(--primary); }
        .nav-add-btn { background: var(--primary); color: #000; width: 55px; height: 55px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.6rem; transform: translateY(-25px); border: 5px solid var(--bg-dark); }

        /* Modals */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); display: none; align-items: center; justify-content: center; z-index: 1000; }
        .modal-box { background: #222; border: 1px solid #444; width: 85%; max-width: 320px; padding: 25px; border-radius: 25px; text-align: center; }
        input { width: 100%; padding: 15px; margin: 8px 0; background: #111; border: 1px solid #333; color: #fff; border-radius: 12px; text-align: center; font-family: 'Cairo'; box-sizing: border-box; }
        .btn-full { width: 100%; padding: 15px; background: var(--primary); color: #000; font-weight: bold; border: none; border-radius: 12px; margin-top: 10px; cursor: pointer; }
        .btn-cancel { background: transparent; color: #888; border: none; margin-top: 10px; }

        /* Password Wrapper */
        .pass-wrap { position: relative; }
        .pass-wrap i { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #666; cursor: pointer; }
    </style>
</head>
<body>

    <div class="top-dashboard">
        <div class="brand-name">BAROUD <span>APP</span></div>
        <div class="balance-card" style="margin-top:15px">
            <div style="font-size:0.8rem; font-weight:bold">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯ÙŠÙˆÙ†</div>
            <div class="balance-amount" id="main-total">$0</div>
        </div>
    </div>

    <div id="projects-view">
        <div class="list-container" id="projects-list"></div>
    </div>

    <div id="details-view" style="display:none; padding: 0 15px;">
        <button class="btn-cancel" onclick="goHome()" style="width:100%; text-align:right">ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
        <h2 id="p-title" style="margin:10px 0"></h2>
        <button class="btn-full" style="background:#25D366; color:#fff; margin-bottom:15px" onclick="openBulk()">ğŸ“¢ ØªØ­ØµÙŠÙ„ Ø§Ù„ÙƒÙ„</button>
        <div id="clients-list"></div>
    </div>

    <div class="bottom-nav">
        <button class="nav-item active" onclick="goHome()"><i class="fa-solid fa-house"></i><span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></button>
        <button class="nav-add-btn" onclick="openAdd()"><i class="fa-solid fa-plus"></i></button>
        <button class="nav-item" onclick="openSettings()"><i class="fa-solid fa-gear"></i><span>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span></button>
    </div>

    <div id="pin-modal" class="modal-overlay">
        <div class="modal-box">
            <h3>ğŸ”’ ÙÙƒ Ø§Ù„Ù‚ÙÙ„</h3>
            <div class="pass-wrap">
                <input type="password" id="pin-in" placeholder="Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ" inputmode="numeric">
                <i class="fa-solid fa-eye" onclick="togglePass('pin-in')"></i>
            </div>
            <button class="btn-full" onclick="verifyPin()">ÙØªØ­</button>
            <button class="btn-cancel" onclick="closePin()">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <div id="add-modal" class="modal-overlay">
        <div class="modal-box">
            <h3 id="m-title">Ø¬Ø¯ÙŠØ¯</h3>
            <div id="p-form">
                <input type="text" id="p-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹">
                <input type="password" id="p-pin" placeholder="Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ (Ø£Ø±Ù‚Ø§Ù…)" inputmode="numeric">
            </div>
            <div id="c-form" style="display:none">
                <input type="text" id="c-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†">
                <input type="tel" id="c-phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
                <input type="number" id="c-amount" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº ($)">
                <input type="text" id="c-desc" placeholder="Ø§Ù„ÙˆØµÙ">
            </div>
            <button class="btn-full" onclick="save()">Ø­ÙØ¸</button>
            <button class="btn-cancel" onclick="closeAdd()">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <div id="bulk-modal" class="modal-overlay">
        <div class="modal-box" style="background:#fff; color:#000">
            <h2 id="b-name"></h2>
            <h1 id="b-total" style="color:red; font-size:3rem">$0</h1>
            <p id="b-count"></p>
            <button class="btn-full" style="background:#25D366; color:#fff" onclick="nextBulk()">Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨</button>
            <button class="btn-cancel" onclick="closeBulk()">Ø¥ÙŠÙ‚Ø§Ù</button>
        </div>
    </div>

<script>
    let db = JSON.parse(localStorage.getItem('baroud_v7')) || [];
    let curP = -1, tempP = -1, editC = -1, isEditP = false;

    function renderHome() {
        const list = document.getElementById('projects-list'); list.innerHTML = '';
        let total = 0;
        db.forEach((p, i) => {
            let pSum = p.clients.reduce((s, c) => s + c.amount, 0);
            total += pSum;
            list.innerHTML += `<div class="app-card" onclick="askPin(${i})"><div class="card-icon"><i class="fa-solid fa-briefcase"></i></div><div class="card-info"><h3>${p.name}</h3><p>${p.clients.length} Ø²Ø¨Ø§Ø¦Ù† â€¢ $${pSum}</p></div></div>`;
        });
        document.getElementById('main-total').innerText = '$' + total;
        document.getElementById('projects-view').style.display = 'block';
        document.getElementById('details-view').style.display = 'none';
    }

    function askPin(i) { tempP = i; document.getElementById('pin-modal').style.display = 'flex'; }
    function verifyPin() {
        if(document.getElementById('pin-in').value == db[tempP].pin) {
            curP = tempP; document.getElementById('pin-modal').style.display = 'none'; renderDetails();
        } else { alert('Ø®Ø·Ø£'); }
    }
    function renderDetails() {
        const list = document.getElementById('clients-list'); list.innerHTML = '';
        const p = db[curP];
        document.getElementById('p-title').innerText = p.name;
        p.clients.forEach((c, i) => {
            list.innerHTML += `<div class="app-card"><div class="card-info"><h3>${c.name}</h3><p>${c.phone} ${c.desc?'â€¢ '+c.desc:''}</p></div><div style="text-align:left"><b>$${c.amount}</b><br><i class="fa-brands fa-whatsapp" onclick="sendWA(${i})" style="color:#25D366; margin-left:10px"></i><i class="fa-solid fa-trash" onclick="delC(${i})" style="color:red"></i></div></div>`;
        });
        document.getElementById('projects-view').style.display = 'none';
        document.getElementById('details-view').style.display = 'block';
    }

    function openAdd() {
        editC = -1; isEditP = false;
        document.getElementById('add-modal').style.display = 'flex';
        document.getElementById('p-form').style.display = curP == -1 ? 'block' : 'none';
        document.getElementById('c-form').style.display = curP == -1 ? 'none' : 'block';
    }

    function save() {
        if(curP == -1) {
            db.push({ name: document.getElementById('p-name').value, pin: document.getElementById('p-pin').value, clients: [] });
        } else {
            db[curP].clients.push({ name: document.getElementById('c-name').value, phone: document.getElementById('c-phone').value, amount: parseFloat(document.getElementById('c-amount').value), desc: document.getElementById('c-desc').value });
        }
        localStorage.setItem('baroud_v7', JSON.stringify(db));
        closeAdd(); curP == -1 ? renderHome() : renderDetails();
    }

    function togglePass(id) { let x = document.getElementById(id); x.type = x.type === "password" ? "text" : "password"; }
    function goHome() { curP = -1; renderHome(); }
    function closePin() { document.getElementById('pin-modal').style.display = 'none'; }
    function closeAdd() { document.getElementById('add-modal').style.display = 'none'; }
    function delC(i) { if(confirm('Ø­Ø°ÙØŸ')) { db[curP].clients.splice(i,1); localStorage.setItem('baroud_v7', JSON.stringify(db)); renderDetails(); }}
    function sendWA(i) {
        let c = db[curP].clients[i];
        window.open(`https://wa.me/961${c.phone}?text=${encodeURIComponent('Ø­Ø³Ø§Ø¨Ùƒ Ù‡Ùˆ: $'+c.amount)}`, '_blank');
    }

    renderHome();
</script>
</body>
</html>
